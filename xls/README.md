这里是使用的说明，具体的设计和实现参见design

程序的主文件夹下的目录：

source      需要被处理的xls源文件

nomatch     程序在正式处理前，会过滤文件，不符合过滤规则的文件将由source目录被移动到这个目录

xls         符合过滤规则的文件将由source目录被移动到这个目录

workdone    在xls目录中的文件，经过处理完毕信息后，移动到这个目录

info        处理得到的信息会被存放在这个目录下面的info.xls文件

dict        字典源文件目录



示例：

    假设现在有三个xls文件需要处理，分别是a.xls, b.xls, c.xls。a.xls中所有表单完全符合过滤规则；b.xls中有两个表单，一个符合过滤规则，一个不符合过滤规则；c.xls中所有表单都不符合规则。

    过滤规则。默认设定表单中必须有一行作为标题，如表单有一行是这样的“姓名 学号 性别 民族”，我把这一行称之为标题行。标题行必须在这个表单的前5行以内，默认超过5行还识别不了是否有标题行则视为没有标题行，没有标题行则不符合过滤规则。

    表单符合标题行的规则之后，开始使用./dict/rowdict字典作为识别标题行的关键词。如表单中前两行是这样的：

        1列   2列     3列    4列

第一行： 我     是  第一 行

第二行：姓名  性别  民族     学号

实际第二行是标题行，因此我们需要程序使用关键在识别出第二行是标题行。

./dict/rowdict字典的关键词写法：

        标题1；标题2；标题3；标题4

 每个标题之间必须使用“；”分割，最后一个标题之后不需要“；”。标题1和标题2是必须的，标题3，标题4可选。

比如说一行中只要含有“姓名”则可以确定就是标题行，那么可以这样写：

        姓名；姓名

比如说一行中含有“姓名”和“性别”才可以确定就是标题行，那么可以这样写：

        姓名；性别

比如说一行中必须含有“姓名”，但是含有“性别”或者“民族”或者“学号”三个中的任意一个就可以确定就是标题行，那么可以这样写（“性别”或者“民族”或者“学号”的位置先后固定顺序，但是“姓名”必须是第一个）：

        姓名；性别；学号；民族



通过rowdict字典里的关键词来识别出表单中的标题行。识别标题行，得到标题行的行号。开始识别标题行中的每一列的列标题，识别列标题由./dict/infodict字典控制。接上面这个例子，识别出标题行是第2行，现在要识别出这一行的每一列的内容，即该列的标题，这里说的识别不是指我们人认识这个标题，而是指使得程序认识，程序可以标记出这个列标题，然后获取./dict/wrdict字典中该列标题的对应在保存文件中的表单中的列号。

infodict字典的写法：

        自定义列名；标题名1，标题名1的其它别名

自定义列名可以用户自己取，必须是英文字母，这是为了避免字符编码的问题。具体示例：

        name；姓名，name，xm

假设表单中，有一列是记录姓名的，该列的标题是“姓名”或者该列的标题是“name”或者该列的标题是“xm”，都会被识别”name“，这个”name“是我们自己为上面的三种列标题统一的名称，它是方便程序标识某一含有上述三个名称之一的列的。所以wrdict字典必须有一行像这样：

        name；3



wrdict字典的写法是这样的：
        列名;写入的列号N

列名必须在infodict字典中存在，写入的列号是指识别出该列标题之后，该列源文件表单中的该列的内容将会被写入到info.xls的默认表单中的第N列。


假设a.xls, b.xls, c.xls中只要有符合条件的表单，格式都是这样的：



         1列   2列       3列     4列    5列  . . . 

第一行： 我     是    第一 行    .  .  .

第二行：姓名  性别    民族      学号    成绩

    . . .  . . .

按照这个格式我们来写一下这三个字典文件：

我们认为如果一行中含有”姓名"和"学号"，说明这是一个标题行，所以rowdict这样写就可以了:

姓名；学号


我们只需要从所有发表格中给提取出姓名和学号两列的数据，然后给两个人定的列标题都对应取一个程序统一识别的名字，infodict这样写：

name；姓名，xm

code；学号，学生证号


参照infodict中统一了程序可以识别的名字，这里wrdict将程序可以识别出来的每一列都在将要写入的info.xls的表单中给它规定列号说明这一列是保存这中类型的数据的：

name；0

code；1


然后，需要将这三个要处理的文件复制到在source文件夹内。执行程序，程序运行完毕。

因为a.xls中所有表单完全符合过滤规则，所以a.xls处理完毕之后被移动到了workdone目录；

b.xls中有两个表单，一个符合过滤规则，一个不符合过滤规则，b.xls中的符合条件的表单会被分离出来使用我们程序自定义的命名方式，所以你会在workdone目录看到一大串奇怪字符命名的文件，而b.xls被移动到了nomatch目录；c.xls中所有表单都不符合规则，所以c.xls被移动到了nomatch目录。

打开info/info.xls，会发现符合条件的表单中所有学生的姓名和学号都被提取出来写在这个文件中。


